<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link
href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@1,400&display=swap"
rel="stylesheet"
/>
<link rel="icon" href="favicon.png" type="image/png" />
    
<title>A storybook for Eric</title>
<style>
@keyframes float {
  0% {
    transform: translateY(0) scale(1);
    opacity: 1;
  }
  100% {
    transform: translateY(-100px) scale(1.5);
    opacity: 0;
  }
}

.cover-image {
  width: 60%;
  max-width: 300px;
  height: auto;
  margin: 1.5rem 0;
  object-fit: contain;
  border: none; /* ç§»é™¤é‚Šæ¡† */
  box-shadow: none; /* ç§»é™¤é™°å½± */
}

.cover-author {
  font-size: 1rem;
  color: #888;
  font-style: italic;
}

.vinyl-container {
  margin-top: 2rem;
  width: 120px;
  height: 120px;
  position: relative;
}
#vinyl {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  transition: transform 0.3s ease;
}
.spin {
  animation: spin 3s linear infinite;
}
@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

#lyrics {
  font-size: 1.2rem;
  max-width: 90%;
  line-height: 1.8;
  text-align: center;
  transition: opacity 0.5s ease;
}
.english-text {
  font-family: "Cormorant Garamond", serif;
  font-size: 1.2rem;
  font-style: italic;
  color: #777;
  margin-top: 1rem;
}
body {
  margin: 0;
  font-family: "Noto Sans TC", sans-serif;
  background: #fffaf8;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
.book {
  position: relative;
  width: 90%;
  max-width: 600px;
  height: 90vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  background: #ffffff;
  border-radius: 16px;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
}

.page {
  flex: 1;
  overflow-y: auto; /* è®“å…§å®¹å¯æ²å‹• */
  padding: 2rem;
  display: none;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  font-size: 1.5rem;
  line-height: 2;
}

.nav {
  position: relative;
  z-index: 2;
  display: flex;
  justify-content: space-between;
  padding: 1rem;
  background: #fffaf8;
}
.page.active {
  display: flex;
}
.nav {
  display: flex;
  justify-content: space-between;
  padding: 1rem;
}
button {
  padding: 0.5rem 1rem;
  background: #ffc0cb;
  border: none;
  border-radius: 8px;
  font-size: 1rem;
  cursor: pointer;
  transition: background 0.3s;
}
button:hover {
  background: #ffa5b4;
}
.cover-title {
  font-size: 2.5rem;
  color: #ff82a9;
  font-weight: bold;
}

/* æ–°å¢ï¼šé€²åº¦ "To Love Page" æŒ‰éˆ•æ¨£å¼ */
#goToLovePageBtn {
  margin-top: 1rem;
  background: #ff82a9;
  color: white;
  display: none;
}
</style>
</head>
<body>
<audio autoplay loop>
<source src="be-my-ocean.mp3" type="audio/mpeg" />
Your browser does not support the audio element.
</audio>

<div class="book">
<div class="page active">
<div class="cover-title">Serendipity</div>
<img src="star.png" alt="cover image" class="cover-image" />
<div class="cover-author">Story by Jenny / æ–‡ãƒ»å…†ç</div>
</div>

<div class="page">
ã€Œæˆ‘ä¸€ç›´ä»¥ç‚ºï¼Œ æˆ‘çš„ä¸–ç•Œæ˜¯ç”±æ•¸å­—çµ„æˆçš„ã€‚<br />ä¸€ã€äºŒã€ä¸‰â€¦â€¦ä¸€ç›´åˆ°åã€‚<br />ä¸€æ­¥ä¸€æ­¥ï¼Œæ•´é½Šåˆæœ‰ç§©åºã€‚ã€
<div class="english-text">
"I always thought my world was made of numbers. One, two, threeâ€¦ all
the way to ten. Step by step, neat and tidy."
</div>
</div>
<div class="page">
ã€Œæˆ‘æœ‰æˆ‘çš„è¨ˆåŠƒã€‚<br />æ¯å€‹æ•¸å­—éƒ½æœ‰ä½ç½®ï¼Œ<br />æ¯æ¢è·¯éƒ½æœ‰è¦å‰‡ã€‚ã€
<div class="english-text">
"I had a plan. Every number had a place. Every path had a rule."
</div>
</div>
<div class="page">
ã€Œç›´åˆ°â€¦â€¦ä½ å‡ºç¾äº†ã€‚ã€
<div class="english-text">"But thenâ€¦ you came."</div>
</div>
<div class="page">
ã€Œä½ ä¸æ˜¯æˆ‘è¨ˆåŠƒè£¡çš„æ•¸å­—ã€‚<br />ä½ ä¸ç…§è¦å‰‡èµ°ã€‚<br />ä½ â€¦â€¦å¾ˆä¸ä¸€æ¨£ã€‚ã€
<div class="english-text">
"You weren't part of my numbers. You didn't follow the rules. You
wereâ€¦ different."
</div>
</div>
<div class="page">
ã€Œä¸€é–‹å§‹ï¼Œæˆ‘å¾ˆå›°æƒ‘ã€‚<br />ä¸€åˆ‡â€¦â€¦æ˜¯ä¸æ˜¯éƒ½å£æ‰äº†ï¼Ÿã€
<div class="english-text">
"At first, I was confused. Was everything broken now?"
</div>
</div>
<div class="page">
ã€Œä½†æ…¢æ…¢åœ°ï¼Œæˆ‘çœ‹è¦‹äº†â€¦â€¦<br />ä¸æ˜¯å£äº†ï¼Œ<br />è€Œæ˜¯è®Šæˆäº†æ–°çš„æ¨£å­ã€‚ã€
<div class="english-text">
"But slowly, I sawâ€¦ It wasn't broken. It was becoming something new."
</div>
</div>
<div class="page">
ã€Œä½ æ²’æœ‰ç ´å£è¦å‰‡ï¼Œ<br />è€Œæ˜¯æˆç‚ºäº†æ–°çš„è¦å‰‡ã€‚ã€
<div class="english-text">
"You didn't ruin the rules. You became the new rule. <br />And now my
heart follows only yours."
</div>
</div>
<div class="page">
ã€Œä½ ä¸æ˜¯ä¾‹å¤–ï¼Œ<br />ä½ æ˜¯æˆ‘å”¯ä¸€çš„å…¬å¼ï¼Œ<br />æ˜¯æˆ‘çš„æ–°ä¸–ç•Œï¼Œæˆ‘çš„ç¾åœ¨<br />å’Œæœªä¾†ã€‚ã€
<div class="english-text">
"You're not the exception. You are my only rule. My world, <br />my
now and my forever."
</div>
</div>
<div class="page">
<div
style="
  font-size: 1.8rem;
  color: #ff82a9;
  margin-bottom: 1rem;
  font-weight: bold;
"
>
To Eric
</div>
ã€Œç·£åˆ†è®“ä½ ä¾†åˆ°æˆ‘èº«é‚Šâ€”â€”<br />
ä¸æ˜¯å¶ç„¶ï¼Œ<br />
è€Œæ˜¯æˆ‘å€‘éˆé­‚ä¹‹é–“å®‰éœåˆå …å®šçš„å¼•åŠ›ï¼Œ<br />
è®“æˆ‘å€‘ç„¡æ³•åˆ†é›¢ã€‚ã€
<div class="english-text">
"Serendipity brought you to meâ€”not by chance, but by the quiet
gravity of our souls <br />refusing to stay apart."
</div>
</div>

<div class="page" id="jukebox-page">
<button id="playSongBtn" style="margin-top: 2rem">
ğŸµ ã€ŠBe My Oceanã€‹
</button>
<div class="vinyl-container">
<img id="vinyl" src="vinyl.png" alt="Vinyl Record" />
</div>
<audio id="jukebox-audio" src="be my ocean.m4a"></audio>
<div
id="lyrics"
style="margin-top: 2rem; font-style: italic; color: #666"
>
<!-- å‹•æ…‹æ­Œè©æœƒå‡ºç¾åœ¨é€™è£¡ -->
</div>
<!-- æ–°å¢çš„æŒ‰éˆ•ï¼Œåœ¨éŸ³æ¨‚çµæŸæˆ–é‡åˆ°å•é¡Œæ™‚é¡¯ç¤º -->
<button id="goToLovePageBtn">ç¹¼çºŒæˆ‘å€‘çš„æ•…äº‹ ğŸ’–</button>
</div>

<div class="page" id="love-page" style="position: relative; background-color: #fef9f4; display: flex; justify-content: center; align-items: center;">
  <img
    src="us.png"
    alt="us"
    style="max-width: 100%; max-height: 100%; object-fit: contain; object-position: center;"
  />
</div>

<div class="nav">
<button id="prevBtn">â† ä¸Šä¸€é </button>
<button id="nextBtn">ä¸‹ä¸€é  â†’</button>
</div>
</div>

<script>
// å…¨åŸŸè®Šæ•¸å®šç¾©
const pages = document.querySelectorAll(".page");
const audio = document.getElementById("jukebox-audio");
const playBtn = document.getElementById("playSongBtn");
const lyricsEl = document.getElementById("lyrics");
const nextBtn = document.getElementById("nextBtn");
const prevBtn = document.getElementById("prevBtn");
const vinyl = document.getElementById("vinyl");
const goToLovePageBtn = document.getElementById("goToLovePageBtn");
let currentPage = 0;
let isPlaying = false;
let songStarted = false;
let audioEndedHandled = false;

// é¡¯ç¤ºæŒ‡å®šé é¢çš„å‡½æ•¸ - åªå®šç¾©ä¸€æ¬¡
function showPage(index) {
  pages.forEach((p, i) => p.classList.toggle("active", i === index));
  
  // ç•¶åˆ°é”æ’­æ”¾éŸ³æ¨‚é‚£é ï¼ˆå€’æ•¸ç¬¬äºŒé ï¼‰æ™‚ï¼Œéš±è—ä¸‹ä¸€é æŒ‰éˆ•
  if (index === pages.length - 2) {
    nextBtn.style.display = "none";
  } else {
    nextBtn.style.display = "inline-block";
  }
  
  // è™•ç†ç¬¬ä¸€é çš„ä¸Šä¸€é æŒ‰éˆ•
  if (index === 0) {
    prevBtn.style.display = "none";
  } else {
    prevBtn.style.display = "inline-block";
  }

  // é‡ç½®éŸ³æ¨‚é é¢ç‹€æ…‹
  if (index === pages.length - 2) {
    goToLovePageBtn.style.display = "none";
    // é¿å…é‡è¤‡æ·»åŠ è¨ˆæ™‚å™¨
    setupSongEndFallback();
  }
}

// ç¿»é å‡½æ•¸
function nextPage() {
  if (currentPage < pages.length - 1) {
    currentPage++;
    showPage(currentPage);
  }
}

function prevPage() {
  if (currentPage > 0) {
    currentPage--;
    showPage(currentPage);
  }
}

// é€²å…¥æœ€å¾Œæ„›å¿ƒé é¢
function goToLovePage() {
  currentPage = pages.length - 1;
  showPage(currentPage);
  
  // é¡¯ç¤ºè¡¨é”æ„›æ„çš„æŒ‰éˆ•
  nextBtn.textContent = "I love you â¤ï¸";
  nextBtn.removeEventListener("click", nextPage);
  nextBtn.addEventListener("click", createHeart);
}

// æ„›å¿ƒå‹•ç•«å‡½æ•¸
function createHeart() {
  const heart = document.createElement("div");
  heart.textContent = "ğŸ’–";
  heart.style.position = "absolute";
  heart.style.left = Math.random() * 90 + "%";
  heart.style.top = Math.random() * 90 + "%";
  heart.style.fontSize = "2rem";
  heart.style.animation = "float 2s ease-out forwards";
  document.querySelector(".book").appendChild(heart);

  setTimeout(() => heart.remove(), 2000);
}

// æ­Œè©æ•¸æ“š
const lyricsData = [
  { time: 0, text: "" },
  { time: 6, text: "I'm in love with you, yes <br />I feel it" },
  { time: 10, text: "Will you be the one to catch these feelings" },
  { time: 16, text: "With you on this bed the air is something" },
  { time: 20, text: "It took my breath away" },
  { time: 26, text: "You're my hopeless devotion" },
  { time: 29, text: "Dealing oh with you, I do with caution" },
  { time: 34, text: "Because I don't want the two of us to be broken" },
  { time: 39, text: "So just take me" },
  { time: 42, text: "Be my ocean <br />What is the commotion?" },
  { time: 46, text: "I just wanna dive in the river" },
  { time: 49, text: "To be with the one I love" },
  { time: 52, text: "And if I tried to hurt you" },
  { time: 55, text: "Still I'd belong to you" },
  { time: 58, text: "Dive in the river" },
  { time: 60, text: "To be with <br />To be with the" },
  { time: 63, text: "Be with the one I love" },
  { time: 69, text: "Am I dead already?" },
  { time: 73, text: "Abandon ship, these waves they tip me over" },
  { time: 78, text: "And I'm just about to sink" },
  { time: 80, text: "But if you're ever down and out" },
  { time: 83, text: "And if there ever is a doubt" },
  { time: 86, text: "Then you call me" },
  { time: 91, text: "Be my ocean <br />What is the commotion?" },
  { time: 95, text: "I just wanna dive in the river" },
  { time: 98, text: "To be with the one I love" },
  { time: 101,text: "And if I tried to hurt you" },
  { time: 105, text: "Still I'd belong to you" },
  { time: 107, text: "Dive in the river" },
  { time: 109, text: "To be with the one I love" },
  { time: 112, text: "Let it be <br />Just you and me" },
  { time: 114, text: "Now if I could drown in you" },
  { time: 117, text: "Baby please <br />I need your release" },
  { time: 119, text: "Now if I could drown in you" },
  { time: 123, text: "" },
  { time: 126, text: "Now if I could drown in you" },
  { time: 128, text: "" },
{ time: 130, text: "å¯¶å¯¶" },
    { time: 132, text: "ä½ çš„å‡ºç¾æ˜¯æµæ˜Ÿ é—–é€²äº†æˆ‘çš„ç”Ÿæ´»" },
    { time: 134, text: "æˆ‘æƒ³" },
    { time: 136, text: "ä¸€å®šæ˜¯æˆ‘æ›¾ç¶“è¨±ä¸‹çš„å¿ƒé¡˜ è®Šæˆä½ " },
    { time: 138, text: "ä¾†åˆ°æˆ‘èº«é‚Šäº†!" },
    { time: 140, text: "è¬è¬ä½ ä¾†äº†" },
     { time: 142, text: "é‚„è«‹ä½ ç¹¼çºŒç•™åœ¨æˆ‘èº«é‚Šæ­! â¤" },
  { time: 145, text: "And if I could" },
  { time: 146, text: "And if I could drown in you" },
  { time: 150, text: "â¤" },

];

// æ­Œæ›²æ’­æ”¾å®Œç•¢æª¢æŸ¥çš„å‚™ç”¨æ–¹æ¡ˆ
function setupSongEndFallback() {
  // ä¿å­˜é–‹å§‹æ’­æ”¾æ™‚é–“ï¼Œç”¨ä¾†è¨ˆç®—é æœŸçµæŸæ™‚é–“
  let songEndCheckerTimer;
  
  // æ¸…é™¤å¯èƒ½å·²å­˜åœ¨çš„è¨ˆæ™‚å™¨
  if (songEndCheckerTimer) {
    clearInterval(songEndCheckerTimer);
  }
  
  // è¨­ç½®ä¸€å€‹æª¢æŸ¥å™¨ï¼Œåœ¨æ’­æ”¾ä¸­é¡¯ç¤ºã€Œç¹¼çºŒã€æŒ‰éˆ•
  songEndCheckerTimer = setInterval(() => {
    // å¦‚æœæ­Œæ›²å·²ç¶“é–‹å§‹æ’­æ”¾
    if (isPlaying) {
      // æª¢æŸ¥æ˜¯å¦æ¥è¿‘æ­Œæ›²çµæŸï¼ˆæ ¹æ“šæœ€å¾Œä¸€æ¢æ­Œè©æ™‚é–“ä¼°ç®—ï¼‰
      const currentTime = audio.currentTime;
      
      // ç•¶æ­Œæ›²æ’­æ”¾åˆ°æ¥è¿‘å°¾è²ï¼ˆæœ€å¾Œä¸€æ¢æ­Œè©å¾Œ5ç§’ï¼‰æ™‚
      if (currentTime >= 150 && !audioEndedHandled) {
        // å·²ç¶“æ¥è¿‘çµæŸï¼Œé¡¯ç¤ºç¹¼çºŒæŒ‰éˆ•
        goToLovePageBtn.style.display = "inline-block";
      }
      
      // å¦‚æœéŸ³æ¨‚å·²ç¶“çµæŸä½†æ²’æœ‰æ­£ç¢ºè§¸ç™¼endedäº‹ä»¶
      if (audio.ended && !audioEndedHandled) {
        handleAudioEnded();
      }
    }
  }, 1000);
}

// è™•ç†éŸ³é »çµæŸçš„å‡½æ•¸
function handleAudioEnded() {
  // æ¨™è¨˜å·²è™•ç†ï¼Œé¿å…é‡è¤‡è§¸ç™¼
  audioEndedHandled = true;
  
  // é¡¯ç¤ºç¹¼çºŒæŒ‰éˆ•
  goToLovePageBtn.style.display = "inline-block";
  
  // åœæ­¢æ—‹è½‰å”±ç‰‡
  vinyl.classList.remove("spin");
  
  // æ›´æ–°æ’­æ”¾æŒ‰éˆ•æ–‡å­—
  playBtn.textContent = "ğŸµ ã€ŠBe My Oceanã€‹";
  isPlaying = false;
}

// äº‹ä»¶ç›£è½å™¨è¨­ç½®
// æ­£ç¢ºè¨­ç½®æŒ‰éˆ•çš„é»æ“Šäº‹ä»¶
nextBtn.addEventListener("click", nextPage);
prevBtn.addEventListener("click", prevPage);
goToLovePageBtn.addEventListener("click", goToLovePage);

// éŸ³æ¨‚æ’­æ”¾æŒ‰éˆ•äº‹ä»¶
playBtn.addEventListener("click", () => {
  if (isPlaying) {
    audio.pause();
    vinyl.classList.remove("spin");
    playBtn.textContent = "ğŸµ ã€ŠBe My Oceanã€‹";
  } else {
    audio.play().catch(err => {
      // è™•ç†æ’­æ”¾å¤±æ•—çš„æƒ…æ³ï¼ˆç‰¹åˆ¥æ˜¯åœ¨ç§»å‹•è¨­å‚™ä¸Šï¼‰
      console.error("æ’­æ”¾å¤±æ•—:", err);
      // é¡¯ç¤ºç¹¼çºŒæŒ‰éˆ•ï¼Œè®“ç”¨æˆ¶å¯ä»¥æ‰‹å‹•é€²å…¥ä¸‹ä¸€é 
      goToLovePageBtn.style.display = "inline-block";
    });
    vinyl.classList.add("spin");
    playBtn.textContent = "â¸ï¸ æˆ‘æ„›ä½ å¯¶å¯¶ â¤ï¸ ";
    songStarted = true;
    audioEndedHandled = false; // é‡ç½®çµæŸæ¨™è¨˜
  }
  isPlaying = !isPlaying;
});

// æ­Œè©æ›´æ–°äº‹ä»¶
audio.addEventListener("timeupdate", () => {
  const currentTime = audio.currentTime;
  const currentLyric = lyricsData
    .slice()
    .reverse()
    .find((line) => currentTime >= line.time);
  if (currentLyric) {
    lyricsEl.innerHTML = currentLyric.text;
  }
});

// éŸ³æ¨‚çµæŸäº‹ä»¶
audio.addEventListener("ended", handleAudioEnded);

// éŸ³é »éŒ¯èª¤è™•ç†
audio.addEventListener("error", () => {
  console.error("éŸ³é »åŠ è¼‰éŒ¯èª¤");
  // é¡¯ç¤ºç¹¼çºŒæŒ‰éˆ•ï¼Œè®“ç”¨æˆ¶å¯ä»¥æ‰‹å‹•é€²å…¥ä¸‹ä¸€é 
  goToLovePageBtn.style.display = "inline-block";
});

// åˆå§‹åŒ–é é¢è¨­ç½®
showPage(currentPage);
// åˆå§‹ç‹€æ…‹ä¸‹éš±è—ä¸Šä¸€é æŒ‰éˆ•
if (currentPage === 0) {
  prevBtn.style.display = "none";
}
</script>
</body>
</html>
